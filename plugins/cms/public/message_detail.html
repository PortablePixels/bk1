<div class="dialog message_detail" ng-controller="message_detail">
  <header>
    <h1>Edit Message</h1>
  </header>
  <section class="pane">

    <p>
      <label>Text</label>
      <textarea ng-model="ui.current_message.text[ui.text_version]" placeholder="Message Text"></textarea>
    </p>

    <h2>Custom Fields</h2>

    <h2>User Input</h2>

    <p>
      <label class="checkbox">
        <input type="checkbox" ng-checked="ui.current_message.capture_input" ng-click="ui.current_message.capture_input=!ui.current_message.capture_input">
        Collect user input
      </label>
    </p>

    <p>
      <label>Key</label>
      <input type="text" ng-model="ui.current_message.key" placeholder="Variable Key Name" />
    </p>

    <div ng-if="ui.current_message.capture_input">
      <div class="toolbar">
        <ul>
          <li>
            <button ng-click="addBranch(ui.current_message)">New Condition</button>
          </li>
        </ul>
        <ul class="right">
          <li>
            <button ng-disabled="!ui.bulkOps" ng-click="deleteBranches()">Delete</button>
          </li>
        </ul>
      </div>
      <table class="cells" cellspacing="0" cellpadding="0">
        <tr class="header" ng-if="ui.current_message.branches.length">
          <th class="select" ng-click="selectAll(ui.current_message.branches)">
              <input type="checkbox" ng-checked="ui.selectAll" />
          </th>
          <th>
            Reply
          </th>
          <th>
            Test
          </th>
          <th>
            Action
          </th>
          <th>
            Quick Reply
          </th>
        </tr>
        <tbody
               dnd-list="ui.current_message.branches"
               dnd-allowed-types="['branch']"
        >


        <tr ng-repeat="branch in ui.current_message.branches" class="ng-class:{selected: branch.$$selected};"
          dnd-draggable="branch"
          dnd-moved="ui.current_message.branches.splice($index, 1);"
          dnd-effect-allowed="move"
          dnd-type="'branch'"
        >
          <td class="cell select" ng-click="select(branch, ui.current_message.branches)" >
              <input type="checkbox" ng-checked="branch.$$selected" />
          </td>
          <td dnd-nodrag>
            <input type="text" ng-model="branch.pattern" placeholder="Pattern" />
          </td>
          <td dnd-nodrag>
            <select><option>Test Type</option></select>
          </td>
          <td dnd-nodrag>
            <select><option>Action</option></select>
          </td>
          <td dnd-nodrag>
            <input type="checkbox" ng-checked="branch.quick_reply" ng-click="branch.quick_reply=!branch.quick_reply"/>
            <input ng-if="branch.quick_reply" ng-model="branch.quick_reply_title" placeholder="Title" />
          </td>
        </tr>
        <tr class="dndPlaceholder"><td colspan="5"></td></tr>
        </tbody>
      </table>
    </div>


  </section>
  <footer>
    <button ng-click="closeDialog($event)">Done</button>
  </footer>
</section>
